$(document).ready(function(){$(".overlay").hide();updateCurrentTab();initOrganigrammeAutocomplete();initIndexAutocomplete();initSearchAutocomplete();$("#searchForm").on("submit",launchSearch);showHideButtonPagination();makeLinkActive()});
function simpleSortColumn(a){var b=$(a).closest(".tableForm");b.find("[data-field]").each(function(){void 0!==$(this).data("value")&&$(this).data("field")!==$(a).data("field")&&($(this).removeData("value"),$(this).removeAttr("data-value"),$(this).prop("data-value",null))});"asc"===$(a).data("value")?$(a).data("value","desc"):"desc"===$(a).data("value")?($(a).removeData("value"),$(a).removeAttr("data-value"),$(a).prop("data-value",null)):$(a).data("value","asc");tableChangeEvent(b)}
function tableChangeEvent(a){var b=a.data("ajaxurl").endsWith("ajax/recherche/resultats")||a.data("ajaxurl").endsWith("ajax/suivi/resultats"),c="";a.find("[data-field]").each(function(){void 0!==$(this).data("value")&&(c+=$(this).data("field")+"\x3d"+$(this).data("value")+"\x26")});a.find("input[data-isForm\x3d'true']").each(function(){void 0!==this.value&&0>c.indexOf(this.name+"\x3d"+this.value)&&(c+=this.name+"\x3d"+this.value+"\x26")});c=b?c+$("#searchForm").serialize():c.substring(0,c.length-
1);a={contentId:b||a.data("ajaxurl").endsWith("ajax/suivi/requete")?"resultList":a[0].id,dataToSend:c,method:b?"POST":"GET",dataType:"html",url:a.data("url"),ajaxUrl:a.data("ajaxurl"),isChangeURL:!b,overlay:$("#"+a[0].id).find(".overlay").first().attr("id"),caller:$(event.target).is(":button")?$(event.target):$(event.target).parent()};callAjaxRequest(a,replaceHtmlFunction)}
function selectAllCheckBox(a){var b=$(a).closest(".tableForm"),c=a.checked,d=$(a).index();b.find("tbody tr").each(function(){$($(this).find("td")[d]).find("input")[0].checked=c})}
function afficheDossier(a){var b=$(a).closest("tr").data("id"),c=$(a).closest(".tableForm"),d="";c.find("[data-field]").each(function(){d+=$(this).data("field")+"\x3d"+$(this).data("value")+"\x26"});c.find("input[data-isForm\x3d'true']").each(function(){d+=this.name+"\x3d"+this.value+"\x26"});d+="dossier\x3d"+b;a={contentId:"monDossier",dataToSend:d,method:"GET",dataType:"html",url:$("#ajaxCallPath").val().substring(0,$("#ajaxCallPath").val().length-5)+"/recherche/resultats",ajaxUrl:$("#ajaxCallPath").val()+
"/dossier",isChangeURL:!0,overlay:$("#monDossier").find(".overlay").first().attr("id"),caller:a};callAjaxRequest(a,replaceHtmlFunction)}function selectDossier(a){$(a).closest("tr").data("id");updateCheckboxHeader(a)}
function updateCheckboxHeader(a){var b=$(a).closest(".tableForm");a=0<$(b).find(":checkbox:checked.js-custom-table-line-check").length;var c=0<$(b).find(":checkbox:not(:checked).js-custom-table-line-check").length,b=$(b).find(":checkbox.js-custom-table-header-check");$(b).prop("indeterminate",a&&c);$(b).prop("checked",a&&!c)}function isRequestAlreadyLaunch(a){return 0>getIndexRequest(a)?!1:!0}
function getIndexRequest(a){var b=-1;$.each(requestWaiting,function(c,d){d.id===a.id&&d.data===a.data&&(b=c)});return b}var replaceHtmlFunction=function(a,b){$("#"+a).html(b)};function onChangePlanType(a){var b=$("#ajaxCallPath").val()+"/corbeille/plan";a={contentId:"planClassementTree",dataToSend:"type\x3d"+a,method:"GET",dataType:"html",ajaxUrl:b,isChangeURL:!1,overlay:$("#planClassementTree").find(".overlay").first().attr("id"),caller:$(event.target).parent()};callAjaxRequest(a,loadTreeData)}
function onClickPlanItem(a){var b=$("#ajaxCallPath").val()+"/corbeille/plan";a={contentId:"planClassementTree",dataToSend:"key\x3d"+a,method:"GET",dataType:"html",ajaxUrl:b,isChangeURL:!1,overlay:$("#planClassementTree").find(".overlay").first().attr("id"),caller:$(event.target).is(":button")?$(event.target):$(event.target).parent()};callAjaxRequest(a,loadTreeData)}
function onChangeMailboxTri(a){var b=$("#ajaxCallPath").val()+"/corbeille/mailbox";a={contentId:"mailboxListTree",dataToSend:"tri\x3d"+a+"\x26masquerCorbeilles\x3d"+$("#masquer_corbeilles").prop("checked"),method:"GET",dataType:"html",ajaxUrl:b,isChangeURL:!1,overlay:$("#mailboxListTree").find(".overlay").first().attr("id"),caller:this};callAjaxRequest(a,replaceHtmlFunction)}
function onClickMailboxItem(a){var b=$("#ajaxCallPath").val()+"/corbeille/mailbox";a={contentId:"mailboxListTree",dataToSend:"key\x3d"+a+"\x26masquerCorbeilles\x3d"+$("#masquer_corbeilles").prop("checked"),method:"GET",dataType:"html",ajaxUrl:b,isChangeURL:!1,overlay:$("#mailboxListTree").find(".overlay").first().attr("id"),caller:$(event.target).is(":button")?$(event.target):$(event.target).parent()};callAjaxRequest(a,loadTreeData)}
function onValidateSelectionMailbox(a,b){$("#selection_poste_user_error").css("display",a||b?"none":"block");var c=$("#ajaxCallPath").val()+"/corbeille/mailbox";a={contentId:"mailboxListTree",dataToSend:"selectionPoste\x3d"+a+"\x26selectionUser\x3d"+b+"\x26isSelectionValidee\x3dtrue\x26masquerCorbeilles\x3d"+$("#masquer_corbeilles").prop("checked"),method:"GET",dataType:"html",ajaxUrl:c,isChangeURL:!1,overlay:$("#mailboxListTree").find(".overlay").first().attr("id"),caller:this};callAjaxRequest(a,
replaceHtmlFunction)}function onClickMasquerCorbeilles(){var a=$("#ajaxCallPath").val()+"/corbeille/mailbox",a={contentId:"mailboxListTree",dataToSend:"masquerCorbeilles\x3d"+$("#masquer_corbeilles").prop("checked"),method:"GET",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:$("#mailboxListTree").find(".overlay").first().attr("id"),caller:this};callAjaxRequest(a,replaceHtmlFunction)}
function chargeOngletDossier(a,b){a="/dossier/"+$("#dossierId").val()+"/"+a;b={contentId:$(b).attr("aria-controls"),dataToSend:$("#dossierLinkId").serialize(),method:"GET",dataType:"html",url:$("#ajaxCallPath").val().substring(0,$("#ajaxCallPath").val().length-5)+a,ajaxUrl:$("#ajaxCallPath").val()+a,isChangeURL:!0,overlay:null,caller:b,extraDatas:{targetURL:a+"?"+$("#dossierLinkId").serialize()}};callAjaxRequest(b,loadOngletData,tabLoadError)}
var loadOngletData=function(a,b,c,d){replaceHtmlFunction(a,b);$(c).removeAttr("onclick");$(c).removeAttr("data-script");var e=d.targetURL;$(c).on("click",function(){pushURLFunction(encodeURI($("#ajaxCallPath").val().substring(0,$("#ajaxCallPath").val().length-5)+e))});initOrganigrammeAutocomplete();initIndexAutocomplete()},loadTreeData=function(a,b,c){replaceHtmlFunction(a,b);$("#"+c.attr("id")).focus()};
function updateCurrentTab(){var a=$(".dossier-onglet.tabulation__item--active");if(a){var b="/dossier/"+$("#dossierId").val()+"/"+a.attr("data-name")+"?"+$("#dossierLinkId").serialize();a.removeAttr("onclick");a.on("click",function(){pushURLFunction(encodeURI($("#ajaxCallPath").val().substring(0,$("#ajaxCallPath").val().length-5)+b))})}}window.tabLoadError=function(a,b,c,d){$("#"+a).html($("\x3cp\x3eUne erreur s'est produite\x3c/p\x3e"))};
function makeLinkActive(){var a=$(location).attr("pathname");$(".quick-access__list").children().each(function(b){$(this).find("a").removeClass("quick-access__link--active");$(this).find("a").attr("href")===a&&$(this).find("a").addClass("quick-access__link--active")})}var reloadPage=function(){window.location.reload()},goPreviousPage=function(){window.location.replace($("#urlPreviousPage").val())};
function verouilleDossier(){var a=$("#ajaxCallPath").val()+"/dossier/verrouille",a={contentId:null,dataToSend:$("#dossierId").serialize(),method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null};callAjaxRequest(a,checkErrorOrReload,displaySimpleErrorMessage)}
function deverouilleDossier(){var a=$("#ajaxCallPath").val()+"/dossier/deverrouille",a={contentId:null,dataToSend:$("#dossierId").serialize(),method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null};callAjaxRequest(a,checkErrorOrReload,displaySimpleErrorMessage)}function deverouilleAdminDossier(){confirm("Etes-vous s√ªr de vouloir lever le verrou ?")&&deverouilleDossier()}
function initIndexAutocomplete(){$(".indexation-autocomplete").each(function(){setupIndexAutocomplete($(this).attr("id"),$(this).attr("data-type"))})}
function setupIndexAutocomplete(a,b){var c=!1;$("#"+a).easyAutocomplete({url:function(a){return $("#ajaxCallPath").val()+"/dossier/suggestions?typeSelection\x3d"+b+"\x26input\x3d"+a},minCharNumber:3,requestDelay:500,highlightPhrase:!0,adjustWidth:!1,theme:"round",template:{type:"custom",method:function(a){return"\x3cspan\x3e"+a+"\x3c/span\x3e"}},list:{maxNumberOfElements:10,match:{enabled:!0},onKeyEnterEvent:function(){if(c){var b=$("#"+a).getSelectedItemData();$("#"+a).val(b);$("#"+a+"-value").val(b)}else $("#"+
a).val(encodeURIComponent(""))},onClickEvent:function(){var b=$("#"+a).getSelectedItemData();$("#"+a).val(b);$("#"+a+"-value").val(b)},onSelectItemEvent:function(){var b=$("#"+a).getSelectedItemData();$("#"+a).val(b);$("#"+a+"-value").val(b);c=!0},onHideListEvent:function(){c=!1}},ajaxSettings:{error:function(a,b,c){}}});$("#"+a).on("input",function(){$("#"+a+"-value").val("")})}
function addIndex(a,b,c,d){c=$("#"+b+"-"+a+("true"==d?"-comp":"")+"-value").val();"motclef_ministere"==b&&(c=$("#"+b+"-"+a+("true"==d?"-comp":"")).val());if(c){var e=$("#"+b+"-"+a+("true"==d?"-comp":"")+"-container");0<e.children("div.indexation-edit-row:contains("+c+")").length||(e.append('\x3cdiv class\x3d"indexation-edit-row"\x3e'+c+'\x3cinput type\x3d"hidden" name\x3d"'+b+("true"==d?"-comp":"")+'" value\x3d"'+c+'"\x3e\x3cbutton type\x3d"button"class\x3d"tree-navigation__button-add base-btn base-btn--button base-btn--default base-btn--icon-action base-btn--transparent index-delete-btn"onclick\x3d"removeIndex(this)"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"icon icon--times-circle icon--v-align icon--big"\x3e\x3c/span\x3e\x3c/button\x3e\x3c/div\x3e'),
$("#"+b+"-"+a+("true"==d?"-comp":"")).val(""),$("#"+b+"-"+a+("true"==d?"-comp":"")+"-value").val(""))}}function removeIndex(a){a.parentNode.remove()}window.saveParapheur=function(a){var b=encodeURIComponent(tinymce.get("mce").getContent());return a+("\x26tinymce\x3d"+b)};
function saveDossier(){var a=$(".tabulation__item--active").attr("data-name"),b=a.charAt(0).toUpperCase()+a.slice(1),c=$("form#dossierForm"+b).serialize()+"\x26"+$("#dossierId").serialize()+"\x26"+$("#dossierLinkId").serialize(),b=window["save"+b];"undefined"!==typeof b&&null!==b&&(c=b(c));a=$("#ajaxCallPath").val()+"/dossier/save/"+a;callAjaxRequest({contentId:null,dataToSend:c,method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null},checkErrorOrReload,displaySimpleErrorMessage)}
function getVersionReponse(a){a=$("#dossierId").serialize()+"\x26"+$("#dossierLinkId").serialize()+"\x26idVersion\x3d"+a+"\x26"+$("#format").serialize();var b=$("#ajaxCallPath").val()+"/dossier/version";callAjaxRequest({contentId:"dossierFormParapheur",dataToSend:a,method:"GET",dataType:"html",ajaxUrl:b,isChangeURL:!1,overlay:null},replaceHtmlFunction)}
window.checkErrorOrReload=function(a,b,c,d,e){a=JSON.parse(b).messages;0<a.dangerMessageQueue.length?constructAlertContainer(a.dangerMessageQueue):reloadPage()};var errorMessageType={cssClass:"alert alert--danger toast toast--shadow",role:"status",hasCloseButton:!0,level:{icon:"icon icon--exclamation-point bubble-icon alert__icon alert__icon--danger",srOnly:"Erreur",isOrdered:!0}};
window.displaySimpleErrorMessage=function(){constructAlert(errorMessageType,["une erreur est survenue sur le serveur"],null)};function unreadDossier(){var a=$("#ajaxCallPath").val()+"/dossier/unread",a={contentId:null,dataToSend:{dossierId:$("#dossierId").val(),dossierLinkId:$("#dossierLinkId").val()},method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null};callAjaxRequest(a,goPreviousPage)}
function pourValidationRetourPM(){var a=$("#ajaxCallPath").val()+"/dossier/validationRetourPM",a={contentId:null,dataToSend:{dossierId:$("#dossierId").val(),dossierLinkId:$("#dossierLinkId").val()},method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null};callAjaxRequest(a,goPreviousOrReloadIfError,displaySimpleErrorMessage)}
function doReattributionQuestion(){var a=$("#ajaxCallPath").val()+"/dossier/reattribution",a={contentId:null,dataToSend:{dossierId:$("#dossierId").val(),dossierLinkId:$("#dossierLinkId").val(),ministereId:$("#ministere-rattachement-key").val()},method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,loadingButton:$("#btn-confirm-deletion")};callAjaxRequest(a,goPreviousOrReloadIfError,displaySimpleErrorMessage)}
function doMettreEnAttente(){var a=$("#ajaxCallPath").val()+"/dossier/attente",a={contentId:null,dataToSend:{dossierId:$("#dossierId").val(),dossierLinkId:$("#dossierLinkId").val()},method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,loadingButton:$("#METTRE_EN_ATTENTE_DOSSIER")};callAjaxRequest(a,goPreviousOrReloadIfError,displaySimpleErrorMessage)}
function doRefusDeSignature(){var a=$("#ajaxCallPath").val()+"/dossier/refusDeSignature",a={contentId:null,dataToSend:{dossierId:$("#dossierId").val(),dossierLinkId:$("#dossierLinkId").val()},method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,loadingButton:$("#REJETER_SIGNER_DOSSIER")};callAjaxRequest(a,goPreviousOrReloadIfError,displaySimpleErrorMessage)}
function doRejetDossierRetour(){var a=$("#ajaxCallPath").val()+"/dossier/rejetRetour",a={contentId:null,dataToSend:{dossierId:$("#dossierId").val(),dossierLinkId:$("#dossierLinkId").val()},method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,loadingButton:$("#REJETER_RETOUR_DOSSIER")};callAjaxRequest(a,goPreviousOrReloadIfError,displaySimpleErrorMessage)}
function doRefusReattribution(){var a=$("#ajaxCallPath").val()+"/dossier/refusReattribution",a={contentId:null,dataToSend:{dossierId:$("#dossierId").val(),dossierLinkId:$("#dossierLinkId").val()},method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null};callAjaxRequest(a,goPreviousOrReloadIfError,displaySimpleErrorMessage)}
function doRejetDossierPoursuivre(){var a=$("#ajaxCallPath").val()+"/dossier/rejetPoursuivre",a={contentId:null,dataToSend:{dossierId:$("#dossierId").val(),dossierLinkId:$("#dossierLinkId").val()},method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,loadingButton:$("#REJETER_DOSSIER")};callAjaxRequest(a,goPreviousOrReloadIfError,displaySimpleErrorMessage)}
function doSigneEtapeSuivante(){var a=$("#ajaxCallPath").val()+"/dossier/signature",a={contentId:null,dataToSend:{dossierId:$("#dossierId").val(),dossierLinkId:$("#dossierLinkId").val()},method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,loadingButton:$("#SIGNER_DOSSIER")};callAjaxRequest(a,goPreviousOrReloadIfError,displaySimpleErrorMessage)}
function doReorientationQuestion(){var a=$("#ajaxCallPath").val()+"/dossier/reorientation",a={contentId:null,dataToSend:{dossierId:$("#dossierId").val(),dossierLinkId:$("#dossierLinkId").val()},method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,loadingButton:$("#REORIENTER_DOSSIER")};callAjaxRequest(a,goPreviousOrReloadIfError,displaySimpleErrorMessage)}
function doEtapeSuivante(){var a=$("#ajaxCallPath").val()+"/dossier/etapeSuivante",a={contentId:null,dataToSend:{dossierId:$("#dossierId").val(),dossierLinkId:$("#dossierLinkId").val()},method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,loadingButton:$("#DONNER_AVIS_FAVORABLE_DOSSIER")};callAjaxRequest(a,goPreviousOrReloadIfError,displaySimpleErrorMessage)}window.goPreviousOrReloadIfError=function(a,b,c,d,e){0<JSON.parse(b).messages.dangerMessageQueue.length?reloadPage():goPreviousPage()};
function populateEditModalWithDocID(a,b){$("#documentId").val(b);$("#group_"+a).attr("checked",!0)}function populateModalDeleteWithDocID(a){$("#documentIdToDelete").val(a)}
function doEditDocumentFondDeDossier(){var a=$("#ajaxCallPath").val()+"/dossier/editDocumentFondDossier",b=$("input:radio[name\x3dgroupName]").filter(":checked").val(),c=$("#documentFile")[0].files,d=new FormData;d.append("documentId",$("#documentId").val());d.append("groupId",b);d.append("documentFile",c);a={contentId:null,dataToSend:d,processData:!1,contentType:!1,enctype:"multipart/form-data",method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,loadingButton:$("#btn-confirm-edit-doc")};
callAjaxRequest(a,checkErrorOrReload,displaySimpleErrorMessage)}function doDeleteDocumentFondDeDossier(){var a=$("#ajaxCallPath").val()+"/dossier/deleteDocumentFondDossier",a={contentId:null,dataToSend:{documentIdToDelete:$("#documentIdToDelete").val()},method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,loadingButton:$("#btn-confirm-deletion-doc")};callAjaxRequest(a,checkErrorOrReload,displaySimpleErrorMessage)}
function doArbitrageSGG(){var a=$("#ajaxCallPath").val()+"/dossier/arbitragesgg",a={contentId:null,dataToSend:{dossierId:$("#dossierId").val(),dossierLinkId:$("#dossierLinkId").val()},method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,loadingButton:$("#btn-confirm-arbitrage-sgg")};callAjaxRequest(a,goPreviousOrReloadIfError,displaySimpleErrorMessage)}function populateModalAddWithGoupID(a){$("#hiddenGroupId").val(a)}
function doAddDocumentFondDeDossier(){var a=$("#ajaxCallPath").val()+"/dossier/addDocumentFondDossier",b=$("#hiddenGroupId").val(),c=$("#documentFile")[0].files,d=new FormData;d.append("groupId",b);d.append("documentFile",c);a={contentId:null,dataToSend:d,processData:!1,contentType:!1,enctype:"multipart/form-data",method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,loadingButton:$("#btn-confirm-add-doc")};callAjaxRequest(a,checkErrorOrReload,displaySimpleErrorMessage)}
function onSelectVersionComparator(a){var b="versioncomparaison__select-first"===$(a).attr("id"),c=$(".versioncomparison__versions_diff .header");a=$(a).children("option:selected").text();var d=a.startsWith("Version")?"":"Version : ",d=d+a;b?c.first().text(d):c.last().text(d)}
function compareVersions(){var a=$("#ajaxCallPath").val()+"/dossier/compare",a={contentId:"versioncomparison__versions",dataToSend:{dossierId:$("#dossierId").val(),dossierLinkId:$("#dossierLinkId").val(),firstVersion:$("#versioncomparaison__select-first").children("option:selected").val(),lastVersion:$("#versioncomparaison__select-last").children("option:selected").val()},method:"GET",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null};callAjaxRequest(a,replaceAndCompareHtmlFunction,displaySimpleErrorMessage)}
var replaceAndCompareHtmlFunction=function(a,b){var c=$(".versioncomparison__versions_diff .header").first().text(),d=$(".versioncomparison__versions_diff .header").last().text();b=comparerAction($(b));$("#"+a).html(b);$(".versioncomparison__versions_diff .header").first().text(c);$(".versioncomparison__versions_diff .header").last().text(d)};
function loadSelectOrganigramme(a,b,c,d,e){var h="orga-"+a;if($("#"+h+" :only-child").hasClass("overlay")){var k=$("#ajaxCallPath").val()+"/organigramme/selectarbre";callAjaxRequest({contentId:h,dataToSend:"typeSelection\x3d"+b+"\x26selectID\x3d"+a+"\x26activatePosteFilter\x3d"+c+"\x26selectedNode\x3d"+d+"\x26isMulti\x3d"+e,method:"GET",dataType:"html",ajaxUrl:k,isChangeURL:!1,overlay:"overlay-"+a,caller:this},replaceHtmlFunction)}}
function onOpenOrganigrammeSelectNode(a,b,c,d,e){var h="orga-"+a,k=$("#ajaxCallPath").val()+"/organigramme/selectarbre";a={contentId:h,dataToSend:"typeSelection\x3d"+b+"\x26selectID\x3d"+a+"\x26activatePosteFilter\x3d"+c+"\x26selectedNode\x3d"+d+"\x26isMulti\x3d"+e,method:"GET",dataType:"html",ajaxUrl:k,isChangeURL:!1,overlay:"overlay-"+a,caller:$(event.target).is(":button")?$(event.target):$(event.target).parent()};callAjaxRequest(a,loadTreeData)}
function addFromOrganigramme(a,b,c,d){$("#"+a).val(c);$("#"+a+"-key").val(b);var e=!1;$("li").each(function(a,b){b.innerText.trim()===c&&(e=!0)});if(!e){var h=$("#list-"+a);$(h).find("ul").append('\x3cli\x3e\x3cinput type\x3d"hidden" name\x3d"'+d+'" value\x3d"'+b+'"\x3e\x3cspan\x3e'+c+'\x3c/span\x3e\x3cbutton type\x3d"button" class\x3d"base-btn base-btn--button base-btn--default base-btn--light base-btn--min" data-tippy-content\x3d"Supprimer" onclick\x3d"removeFromOrganigrammeSelect(this)"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"icon icon--times-circle icon-grey" style\x3d"display: inline-flex; font-size: 1.125em;"\x3e\x3c/span\x3e\x3c/button\x3e\x3c/li\x3e')}$("#modal-"+
a).find(".interstitial__close").click()}function removeFromOrganigrammeSelect(a){a.closest("li").remove();0==$("#list-unite-structurelle-rattachement").find("li").length&&$("#unite-structurelle-rattachement").val("")}function selectFromOrganigramme(a,b,c){$("#"+a).val(c);$("#"+a+"-key").val(b);$("#modal-"+a).find(".interstitial__close").click()}
function initOrganigrammeAutocomplete(){$(".organigramme-autocomplete").each(function(){setupOrganigrammeAutocomplete($(this).attr("id"),$(this).attr("data-type"),$(this).attr("data-poste-filter"))})}
function setupOrganigrammeAutocomplete(a,b,c){var d=!1;$("#"+a).easyAutocomplete({url:function(a){return $("#ajaxCallPath").val()+"/organigramme/suggestions?typeSelection\x3d"+b+"\x26input\x3d"+a+"\x26activatePosteFilter\x3d"+c},minCharNumber:3,getValue:"label",requestDelay:500,highlightPhrase:!0,adjustWidth:!1,theme:"round",template:{type:"custom",method:function(a){return"\x3cspan\x3e"+a+"\x3c/span\x3e"}},list:{maxNumberOfElements:20,onKeyEnterEvent:function(){if(d){var b=$("#"+a).getSelectedItemData();
$("#"+a).val(b.label);$("#"+a+"-key").val(b.key)}else $("#"+a).val(encodeURIComponent("")),$("#"+a+"-key").val("")},onClickEvent:function(){var b=$("#"+a).getSelectedItemData();$("#"+a).val(b.label);$("#"+a+"-key").val(b.key)},onSelectItemEvent:function(){var b=$("#"+a).getSelectedItemData();$("#"+a).val(b.label);$("#"+a+"-key").val(b.key);d=!0},onHideListEvent:function(){d=!1}},ajaxSettings:{error:function(a,b,c){}}});$("#"+a).on("input",function(){$("#"+a+"-key").val("")})}
function onChangeOrganigrammeDisplayMode(a){var b=$("#ajaxCallPath").val()+"/organigramme/arbre";a={contentId:"organigrammeTree",dataToSend:"showDeactivated\x3d"+a,method:"GET",dataType:"html",ajaxUrl:b,isChangeURL:!1,overlay:$("#organigrammeTree").find(".overlay").first().attr("id"),caller:$(event.target).parent()};callAjaxRequest(a,loadOrganigrammeTreeData)}
function onOpenOrganigrammeNode(a){var b=$("#ajaxCallPath").val()+"/organigramme/arbre";a={contentId:"organigrammeTree",dataToSend:"selectedNode\x3d"+a,method:"GET",dataType:"html",ajaxUrl:b,isChangeURL:!1,overlay:$("#organigrammeTree").find(".overlay").first().attr("id"),caller:$(event.target).is(":button")?$(event.target):$(event.target).parent()};callAjaxRequest(a,loadOrganigrammeTreeData)}
var loadOrganigrammeTreeData=function(a,b,c){loadTreeData(a,b,c);initInterstitialSword()},onDeletedNodeFunc=function(a,b,c){a=jQuery.parseJSON(b);"OK"===a.status?(closeDeleteModal(),window.location.reload()):(a=a.file,$("#remove-node-confirmation").hide(),$("#download-excel-message").show(),$("#download-excel-link").text(a),$("#download-excel-link").prop("data-parameters",a),$("#btn-confirm-deletion").hide())};
function downloadExcel(a){a=$(a)[0].attributes["data-controls"].value;var b=$("#download-excel-link").prop("data-parameters");a=a.concat("?fileName\x3d"+b);window.open(a)}function closeDeleteModal(){var a=$("#modal-node-suppression")[0];a.classList.contains("interstitial-overlay__content--visible")&&a.classList.remove("interstitial-overlay__content--visible")}function resetDeleteModal(){$("#remove-node-confirmation").show();$("#download-excel-message").hide();$("#btn-confirm-deletion").show()}
function deleteNode(){var a=$("#ajaxCallPath").val()+"/organigramme/deleteNode",a={contentId:"organigrammeTree",dataToSend:"nodeId\x3d"+$("#nodeId").val()+"\x26nodeType\x3d"+$("#nodeType").val(),method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:$("#modal-node-suppression").find(".overlay").first().attr("id"),caller:this};callAjaxRequest(a,onDeletedNodeFunc)}
$(document).ready(function(){$(".interstitial-overlay__content").on("click",function(a){a.target.classList.contains("interstitial-overlay__content--visible")||"modal-node-suppression"!==a.target.id||resetDeleteModal()});$(".interstitial__close").on("click",function(a){a=$(a.target).closest(".interstitial-overlay__content").get(0);a.classList.contains("interstitial-overlay__content--visible")||"modal-node-suppression"!==a.id||resetDeleteModal()})});
function organigrammeCopyNode(a){var b=$(a).parents(".base-tooltip"),c=$(b).children('input[name\x3d"nodeId"]').val(),b=$(b).children('input[name\x3d"nodeType"]').val(),d=$("#ajaxCallPath").val()+"/organigramme/copy";a={contentId:"organigrammeTree",dataToSend:"nodeId\x3d"+c+"\x26nodeType\x3d"+b,method:"POST",dataType:"html",ajaxUrl:d,isChangeURL:!1,overlay:$("#organigrammeTree").find(".overlay").first().attr("id"),caller:$(a)};callAjaxRequest(a,loadOrganigrammeTreeData)}
function organigrammePasteNode(a,b){var c=$(a).parents(".base-tooltip"),d=$(c).children('input[name\x3d"nodeId"]').val(),c=$(c).children('input[name\x3d"nodeType"]').val(),e=$("#ajaxCallPath").val()+"/organigramme/paste";a={contentId:"organigrammeTree",dataToSend:"nodeId\x3d"+d+"\x26nodeType\x3d"+c+"\x26withUsers\x3d"+b,method:"POST",dataType:"html",ajaxUrl:e,isChangeURL:!1,overlay:$("#organigrammeTree").find(".overlay").first().attr("id"),caller:$(a)};callAjaxRequest(a,loadOrganigrammeTreeData)}
function onActivation(a){var b=$(a).parents(".base-tooltip"),c=$(b).children('input[name\x3d"nodeId"]').val(),b=$(b).children('input[name\x3d"nodeType"]').val(),d=$("#ajaxCallPath").val()+"/organigramme/activation";a={contentId:"organigrammeTree",dataToSend:"typeSelection\x3d"+b+"\x26selectID\x3d"+c+"\x26activate\x3dtrue",method:"GET",dataType:"html",ajaxUrl:d,isChangeURL:!1,overlay:$("#organigrammeTree").find(".overlay").first().attr("id"),caller:$(a)};callAjaxRequest(a,loadOrganigrammeTreeData)}
function onDeActivation(a){var b=$(a).parents(".base-tooltip"),c=$(b).children('input[name\x3d"nodeId"]').val(),b=$(b).children('input[name\x3d"nodeType"]').val(),d=$("#ajaxCallPath").val()+"/organigramme/activation";a={contentId:"organigrammeTree",dataToSend:"typeSelection\x3d"+b+"\x26selectID\x3d"+c+"\x26activate\x3dfalse",method:"GET",dataType:"html",ajaxUrl:d,isChangeURL:!1,overlay:$("#organigrammeTree").find(".overlay").first().attr("id"),caller:$(a)};callAjaxRequest(a,loadOrganigrammeTreeData)}
function exportOrganigramme(){window.location.href=$("#ajaxCallPath").val()+"/organigramme/export"}function onEnterPageNumber(a,b){"Enter"==a.key&&goToPage(b,b.val())}function previousPage(a){a=$(a).closest(".tableForm");var b=a.find('[name\x3d"page"]');b.val(parseInt(b.val())-1);tableChangeEvent(a)}function nextPage(a){a=$(a).closest(".tableForm");var b=a.find('[name\x3d"page"]');b.val(parseInt(b.val())+1);tableChangeEvent(a)}
function goToPage(a,b){a=$(a).closest(".tableForm");a.find('[name\x3d"page"]').val(b);tableChangeEvent(a)}function launchSearch(a){a.preventDefault();a=$("#ajaxCallPath").val()+"/recherche/resultats";a={contentId:"resultList",dataToSend:$("#searchForm").serialize(),method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,caller:this,loadingButton:$(this).find("button[type\x3d'submit']")};callAjaxRequest(a,replaceHtmlFunction,tabLoadError)}
function reinitSearch(a){a={contentId:null,dataToSend:null,method:"POST",dataType:"html",ajaxUrl:$("#ajaxCallPath").val()+"/recherche/reinit",isChangeURL:!1,overlay:null,caller:this};callAjaxRequest(a,reloadPage)}
function cleanSearchForm(a){$(a).closest("form").find("input[type\x3dtext], input[type\x3dhidden], textarea").val("");$(a).closest("form").find("input[type\x3dradio], input[type\x3dcheckbox]").prop("checked",!1);$("#rechercheSur-TOUS").prop("checked",!0);$(a).closest("form").find("select").prop("selectedIndex",0);$("#indexMinistere-remove-all-button,#indexAn-remove-all-button,#indexSenat-remove-all-button").each(function(){$(this).click()})}
function launchRapidSearch(a){var b=$("#ajaxCallPath").val()+"/recherche/fdrrapide",b={contentId:"listeModeles",dataToSend:$("#searchIntitule").serialize(),method:"GET",dataType:"html",ajaxUrl:b,isChangeURL:!0,overlay:"result_overlay",caller:this,loadingButton:$(a.target),url:$("#listeModeles").data("url")};a.preventDefault();callAjaxRequest(b,replaceHtmlFunction,displaySimpleErrorMessage)}function reinitRapidSearch(a){$("#searchIntitule").val("");launchRapidSearch(a)}
function initSearchAutocomplete(){$(".auteur-autocomplete, .intituleFdr-autocomplete").each(function(){setupSearchAutocomplete($(this).attr("id"),$(this).attr("data-type"))});$(".index-autocomplete").each(function(a,b){a="Ministere"==$(this).attr("data-type");$(b).select2({minimumInputLength:a?1:3,maximumSelectionLength:0,multiple:!0,tags:a,dropdownParent:a?null:$(b).closest(".form-select-input"),ajax:a?null:{url:$("#ajaxCallPath").val()+"/recherche/suggestions",dataType:"json",delay:500,data:function(a){return{input:a.term,
typeSelection:$(this).attr("data-type")}},processResults:function(a){return{results:$.map(a,function(a){return{text:a,id:a}})}}}}).change(function(a){$("#"+a.currentTarget.name+"-remove-all-button").toggleClass("form-select__button--hidden",""===a.currentTarget.value)})});$(".form-select-input .select2-container .select2-selection").addClass("select2-selection--tags")}
function setupSearchAutocomplete(a,b){var c=!1;$("#"+a).easyAutocomplete({url:function(a){return $("#ajaxCallPath").val()+"/recherche/suggestions?input\x3d"+a+"\x26typeSelection\x3d"+b},minCharNumber:3,requestDelay:500,highlightPhrase:!0,adjustWidth:!1,theme:"round",template:{type:"custom",method:function(a){return"\x3cspan\x3e"+a+"\x3c/span\x3e"}},list:{maxNumberOfElements:10,match:{enabled:!0},onKeyEnterEvent:function(){if(c){var b=$("#"+a).getSelectedItemData();$("#"+a).val(b);$("#"+a+"-value").val(b)}else $("#"+
a).val(encodeURIComponent(""))},onClickEvent:function(){var b=$("#"+a).getSelectedItemData();$("#"+a).val(b);$("#"+a+"-value").val(b)},onSelectItemEvent:function(){var b=$("#"+a).getSelectedItemData();$("#"+a).val(b);$("#"+a+"-value").val(b);c=!0},onHideListEvent:function(){c=!1}},ajaxSettings:{error:function(a,b,c){}}});$("#"+a).on("input",function(){$("#"+a+"-value").val("")})}
function selectChampRequete(a){var b=$("#ajaxCallPath").val()+"/suivi/select-champ";callAjaxRequest({contentId:"requeteField",dataToSend:"id\x3d"+a,method:"GET",dataType:"html",ajaxUrl:b,isChangeURL:!1,overlay:null,caller:this},onSelectChampRequete,displaySimpleErrorMessage)}
function onSelectOperator(){var a=$("#selectOperator option:selected").data("display"),b=$(".second-date");a&&("displayOne"==a?(b.hide(),b.find("input").prop("disabled",!0)):"displayTwo"==a&&(b.show(),b.find("input").prop("disabled",!1)))}var onSelectChampRequete=function(a,b,c){replaceHtmlFunction(a,b);initSearchAutocomplete();initOrganigrammeAutocomplete()};
function addElementToRequete(){if(isValidForm($("#requeteExperteChamp"))){var a=$("#ajaxCallPath").val()+"/suivi/add",b=$("#requeteExperteChamp").serialize(),c=$("select#value option:selected");c&&c.each(function(a,c){b+="\x26displayValue\x3d"+c.text});a={contentId:"requeteTable",dataToSend:b,method:"POST",dataType:"html",ajaxUrl:a,isChangeURL:!1,overlay:null,caller:this,loadingButton:$("button#add-champ-button")};callAjaxRequest(a,reloadPage,displaySimpleErrorMessage)}}
function removeLineToRequete(a){var b=$("#ajaxCallPath").val()+"/suivi/remove";callAjaxRequest({contentId:"requeteTable",dataToSend:"order\x3d"+a,method:"GET",dataType:"html",ajaxUrl:b,isChangeURL:!1,overlay:"table_requete_overlay",caller:this},replaceHtmlFunction,displaySimpleErrorMessage)}
function moveRequeteLine(a,b){var c=$("#ajaxCallPath").val()+"/suivi/move";callAjaxRequest({contentId:"requeteTable",dataToSend:"order\x3d"+a+"\x26direction\x3d"+b,method:"GET",dataType:"html",ajaxUrl:c,isChangeURL:!1,overlay:"table_requete_overlay",caller:this},replaceHtmlFunction,displaySimpleErrorMessage)}
function reinitRequete(){var a={contentId:"requeteTable",dataToSend:null,method:"GET",dataType:"html",ajaxUrl:$("#ajaxCallPath").val()+"/suivi/reinit",isChangeURL:!1,overlay:null,caller:this,loadingButton:$("button#reinit-requete-button")};callAjaxRequest(a,reloadPage,displaySimpleErrorMessage)}
function launchRequete(){var a={contentId:"resultList",dataToSend:null,method:"POST",dataType:"html",ajaxUrl:$("#ajaxCallPath").val()+"/suivi/resultats",isChangeURL:!1,overlay:null,caller:this,loadingButton:$("button#launch-requete-button")};callAjaxRequest(a,replaceHtmlFunction,displaySimpleErrorMessage)}
var styleDelete=styleDelete||"versioncomparison__del",styleInsert=styleInsert||"versioncomparison__ins",styleMoved=styleMoved||"font-weight: bold; vertical-align: text-bottom; font-size: xx-small; padding: 0; border: solid 1px;",styleBlock=styleBlock||"background-color: #ffff44;,background-color: #b0ff90;,background-color: #ffcc99;,background-color: #99ffff;,background-color: #99ccff;,background-color: #cc99ff;,background-color: #ff99cc;,background-color: #ffd040;,background-color: #d0d0d0;".split(","),
htmlMovedRight=htmlMovedRight||'\x3cinput type\x3d"button" value\x3d"\x26gt;" style\x3d"'+styleMoved+' {block}"/\x3e',htmlMovedLeft=htmlMovedLeft||'\x3cinput type\x3d"button" value\x3d"\x26lt;" style\x3d"'+styleMoved+' {block}"/\x3e',htmlBlockStart=htmlBlockStart||'\x3cspan style\x3d"{block}"\x3e',htmlBlockEnd=htmlBlockEnd||"\x3c/span\x3e",htmlDeleteStart=htmlDeleteStart||'\x3cspan class\x3d"'+styleDelete+'"\x3e',htmlDeleteEnd=htmlDeleteEnd||"\x3c/span\x3e",htmlInsertStart=htmlInsertStart||'\x3cspan class\x3d"'+
styleInsert+'"\x3e',htmlInsertEnd=htmlInsertEnd||"\x3c/span\x3e",blockMinLength=blockMinLength||1E6,wordDiff=wordDiff||!0,recursiveDiff=recursiveDiff||!0,showBlockMoves=showBlockMoves||!0,i,j,m,n;
function StringDiff(a,b){var c={newWords:[],oldWords:[],newToOld:[],oldToNew:[],message:""},d={};if(a==b)return a=Escape(b),a=HtmlFormat(a);if(null==a||0==a.length)return a=Escape(b),a=HtmlFormat(a),a=htmlInsertStart+a+htmlInsertEnd;if(null==b||0==b.length)return a=Escape(a),a=HtmlFormat(a),a=htmlDeleteStart+a+htmlDeleteEnd;SplitText(a,b,c);TextDiff(c);DetectBlocks(c,d);return a=DiffToHtml(c,d)}
function StringDiff1(a,b){var c={newWords:[],oldWords:[],newToOld:[],oldToNew:[],message:""},d={};if(a==b)return a=Escape(b),a=HtmlFormat(a);if(null==a||0==a.length)return a=Escape(b),a=HtmlFormat(a),a=htmlInsertStart+a+htmlInsertEnd;SplitText(a,b,c);TextDiff(c);DetectBlocks(c,d);return a=DiffToHtml1(c,d)}
function StringDiff2(a,b){var c={newWords:[],oldWords:[],newToOld:[],oldToNew:[],message:""},d={};if(a==b)return a=Escape(b),a=HtmlFormat(a);if(null==b||0==b.length)return a=Escape(a),a=HtmlFormat(a),a=htmlDeleteStart+a+htmlDeleteEnd;SplitText(a,b,c);TextDiff(c);DetectBlocks(c,d);return a=DiffToHtml2(c,d)}
function SplitText(a,b,c){a=a.replace(/[\t\v\u00A0\u2028\u2029]+/g," ");b=b.replace(/[\t\v\u00A0\u2028\u2029]+/g," ");var d=/[\w]+|\[\[|\]\]|\{\{|\}\}|\n+| +|&\w+;|'''|''|=+|\{\||\|\}|\|\-|./g,e;do e=d.exec(a),null!=e&&c.oldWords.push(e[0]);while(null!=e);do e=d.exec(b),null!=e&&c.newWords.push(e[0]);while(null!=e)}
function TextDiff(a,b,c,d,e,h){symbol={newCtr:[],oldCtr:[],toNew:[],toOld:[]};b=b||0;c=c||a.newWords.length;d=d||0;e=e||a.oldWords.length;h=h||0;if(!(10<h)){var k;for(i=b;i<c;i++)k=a.newWords[i],null==symbol[k]&&(symbol[k]={newCtr:0,oldCtr:0,toNew:null,toOld:null}),symbol[k].newCtr++,symbol[k].toNew=i;for(j=d;j<e;j++)k=a.oldWords[j],null==symbol[k]&&(symbol[k]={newCtr:0,oldCtr:0,toNew:null,toOld:null}),symbol[k].oldCtr++,symbol[k].toOld=j;for(i in symbol)if(1==symbol[i].newCtr&&1==symbol[i].oldCtr){k=
symbol[i].toNew;var p=symbol[i].toOld;/\s/.test(a.newWords[k])||(a.newToOld[k]=p,a.oldToNew[p]=k)}for(i=b;i<c-1;i++)null!=a.newToOld[i]&&(j=a.newToOld[i],null==a.newToOld[i+1]&&null==a.oldToNew[j+1]&&a.newWords[i+1]==a.oldWords[j+1]&&(a.newToOld[i+1]=j+1,a.oldToNew[j+1]=i+1));for(i=c-1;i>b;i--)null!=a.newToOld[i]&&(j=a.newToOld[i],null==a.newToOld[i-1]&&null==a.oldToNew[j-1]&&a.newWords[i-1]==a.oldWords[j-1]&&(a.newToOld[i-1]=j-1,a.oldToNew[j-1]=i-1));if(recursiveDiff)for(i=b,j=d;i<c;)if(null!=a.newToOld[i-
1]&&(j=a.newToOld[i-1]+1),null==a.newToOld[i]&&null==a.oldToNew[j]){for(p=k=i;null==a.newToOld[p]&&p<c;)p++;for(var q=p-k,f=j,g=j;null==a.oldToNew[g]&&g<e;)g++;var t=g-f;0<q&&0<t&&(1<q||1<t)&&(k==b&&p==c&&f==d&&g==e||TextDiff(a,k,p,f,g,h+1));i=p}else i++;if(recursiveDiff)for(i=c-1,j=e-1;i>=b;)if(null!=a.newToOld[i+1]&&(j=a.newToOld[i+1]-1),null==a.newToOld[i]&&null==a.oldToNew[j]){k=i;for(p=i+1;null==a.newToOld[k-1]&&k>=b;)k--;q=p-k;f=j;for(g=j+1;null==a.oldToNew[f-1]&&f>=d;)f--;t=g-f;0<q&&0<t&&(1<
q||1<t)&&(k==b&&p==c&&f==d&&g==e||TextDiff(a,k,p,f,g,h+1));i=k-1}else i--}}
function DiffToHtml(a,b){var c=a.message,d=0;j=i=0;do{var e=[],h=[],k=[],p="",q="",f="",g="",t="",v="";if((a.newToOld[i]!=j||0==d)&&(null!=a.newToOld[i]||i>=a.newWords.length)&&(null!=a.oldToNew[j]||j>=a.oldWords.length)){var l=b.newRight[d];if(0<l){var r=b.newRightIndex[d];e.push(r);h.push(l);k.push(!1)}l=b.newLeft[d];0<l&&(r=b.newLeftIndex[d],e.push(r),h.push(l),k.push(!0));l=b.newBlock[d];0<l&&(b.newWords[d]<blockMinLength?(t=htmlInsertStart,v=htmlInsertEnd):(l>styleBlock.length&&(l=styleBlock.length),
t=HtmlCustomize(htmlBlockStart,l-1),v=htmlBlockEnd));i>=a.newWords.length?i++:(j=a.newToOld[i],d++)}2==e.length&&e[0]>e[1]&&(e.reverse(),h.reverse(),k.reverse());for(m=0;m<e.length;m++)if(b.newWords[e[m]]<blockMinLength){var l=b.newStart[e[m]],r=b.newLength[e[m]],u="";for(n=l;n<l+r;n++)u+=a.newWords[n];u=u.replace(/\n/g,"\x26para;\x3cbr/\x3e");p+=htmlDeleteStart+Escape(u)+htmlDeleteEnd;p+=Escape(u)}else h[m]>styleBlock.length&&(h[m]=styleBlock.length),p=k[m]?p+HtmlCustomize(htmlMovedLeft,h[m]-1):
p+HtmlCustomize(htmlMovedRight,h[m]-1);for(;i<a.newWords.length&&j<a.oldWords.length&&null!=a.newToOld[i]&&null!=a.oldToNew[j]&&a.newToOld[i]==j;)q+=a.newWords[i],i++,j++;for(;null==a.oldToNew[j]&&j<a.oldWords.length;)f+=a.oldWords[j],j++;for(;null==a.newToOld[i]&&i<a.newWords.length;)g+=a.newWords[i],i++;h=e="";if(wordDiff&&""!=f&&""!=g){for(;f.charAt(0)==g.charAt(0);)e+=f.charAt(0),f=f.substr(1),g=g.substr(1);for(;f.charAt(f.length-1)==g.charAt(g.length-1);)h=f.charAt(f.length-1)+h,f=f.substr(0,
f.length-1),g=g.substr(0,g.length-1)}""!=p&&(c+=p);""!=q&&(c+=t+Escape(q)+v);c+=e;""!=f&&(f=htmlDeleteStart+Escape(f)+htmlDeleteEnd,f=f.replace(/\n/g,"\x26para;\x3cbr/\x3e"),c+=f);""!=g&&(g=htmlInsertStart+Escape(g)+htmlInsertEnd,g=g.replace(/\n/g,"\x26para;\x3cbr/\x3e"),c+=g);c+=h}while(i<=a.newWords.length);return c=HtmlFormat(c+"\n")}
function DiffToHtml1(a,b){var c=a.message,d=0;j=i=0;do{var e=[],h=[],k=[],p="",q="",f="",g="",t="",v="";if((a.newToOld[i]!=j||0==d)&&(null!=a.newToOld[i]||i>=a.newWords.length)&&(null!=a.oldToNew[j]||j>=a.oldWords.length)){var l=b.newRight[d];if(0<l){var r=b.newRightIndex[d];e.push(r);h.push(l);k.push(!1)}l=b.newLeft[d];0<l&&(r=b.newLeftIndex[d],e.push(r),h.push(l),k.push(!0));l=b.newBlock[d];0<l&&(b.newWords[d]<blockMinLength?(t=htmlInsertStart,v=htmlInsertEnd):(l>styleBlock.length&&(l=styleBlock.length),
t=HtmlCustomize(htmlBlockStart,l-1),v=htmlBlockEnd));i>=a.newWords.length?i++:(j=a.newToOld[i],d++)}2==e.length&&e[0]>e[1]&&(e.reverse(),h.reverse(),k.reverse());for(m=0;m<e.length;m++)if(b.newWords[e[m]]<blockMinLength){var l=b.newStart[e[m]],r=b.newLength[e[m]],u="";for(n=l;n<l+r;n++)u+=a.newWords[n];u=u.replace(/\n/g,"\x26para;\x3cbr/\x3e");p+=Escape(u)}else h[m]>styleBlock.length&&(h[m]=styleBlock.length),p=k[m]?p+HtmlCustomize(htmlMovedLeft,h[m]-1):p+HtmlCustomize(htmlMovedRight,h[m]-1);for(;i<
a.newWords.length&&j<a.oldWords.length&&null!=a.newToOld[i]&&null!=a.oldToNew[j]&&a.newToOld[i]==j;)q+=a.newWords[i],i++,j++;for(;null==a.oldToNew[j]&&j<a.oldWords.length;)f+=a.oldWords[j],j++;for(;null==a.newToOld[i]&&i<a.newWords.length;)g+=a.newWords[i],i++;h=e="";if(wordDiff&&""!=f&&""!=g){for(;f.charAt(0)==g.charAt(0);)e+=f.charAt(0),f=f.substr(1),g=g.substr(1);for(;f.charAt(f.length-1)==g.charAt(g.length-1);)h=f.charAt(f.length-1)+h,f=f.substr(0,f.length-1),g=g.substr(0,g.length-1)}""!=p&&(c+=
p);""!=q&&(c+=t+Escape(q)+v);c+=e;""!=g&&(g=htmlInsertStart+Escape(g)+htmlInsertEnd,g=g.replace(/\n/g,"\x26para;\x3cbr/\x3e"),c+=g);c+=h}while(i<=a.newWords.length);return c=HtmlFormat(c+"\n")}
function DiffToHtml2(a,b){var c=a.message,d=0;j=i=0;do{var e=[],h=[],k=[],p="",q="",f="",g="",t="",v="";if((a.newToOld[i]!=j||0==d)&&(null!=a.newToOld[i]||i>=a.newWords.length)&&(null!=a.oldToNew[j]||j>=a.oldWords.length)){var l=b.newRight[d];if(0<l){var r=b.newRightIndex[d];e.push(r);h.push(l);k.push(!1)}l=b.newLeft[d];0<l&&(r=b.newLeftIndex[d],e.push(r),h.push(l),k.push(!0));l=b.newBlock[d];0<l&&!(b.newWords[d]<blockMinLength)&&(l>styleBlock.length&&(l=styleBlock.length),t=HtmlCustomize(htmlBlockStart,
l-1),v=htmlBlockEnd);i>=a.newWords.length?i++:(j=a.newToOld[i],d++)}2==e.length&&e[0]>e[1]&&(e.reverse(),h.reverse(),k.reverse());for(m=0;m<e.length;m++)if(b.newWords[e[m]]<blockMinLength){var l=b.newStart[e[m]],r=b.newLength[e[m]],u="";for(n=l;n<l+r;n++)u+=a.newWords[n];u=u.replace(/\n/g,"\x26para;\x3cbr/\x3e");p+=htmlDeleteStart+Escape(u)+htmlDeleteEnd}else h[m]>styleBlock.length&&(h[m]=styleBlock.length),p=k[m]?p+HtmlCustomize(htmlMovedLeft,h[m]-1):p+HtmlCustomize(htmlMovedRight,h[m]-1);for(;i<
a.newWords.length&&j<a.oldWords.length&&null!=a.newToOld[i]&&null!=a.oldToNew[j]&&a.newToOld[i]==j;)q+=a.newWords[i],i++,j++;for(;null==a.oldToNew[j]&&j<a.oldWords.length;)f+=a.oldWords[j],j++;for(;null==a.newToOld[i]&&i<a.newWords.length;)g+=a.newWords[i],i++;h=e="";if(wordDiff&&""!=f&&""!=g){for(;f.charAt(0)==g.charAt(0);)e+=f.charAt(0),f=f.substr(1),g=g.substr(1);for(;f.charAt(f.length-1)==g.charAt(g.length-1);)h=f.charAt(f.length-1)+h,f=f.substr(0,f.length-1),g=g.substr(0,g.length-1)}""!=p&&(c+=
p);""!=q&&(c+=t+Escape(q)+v);c+=e;""!=f&&(f=htmlDeleteStart+Escape(f)+htmlDeleteEnd,f=f.replace(/\n/g,"\x26para;\x3cbr/\x3e"),c+=f);c+=h}while(i<=a.newWords.length);return c=HtmlFormat(c+"\n")}function Escape(a){return a}function HtmlCustomize(a,b){a=a.replace(/\{number\}/,b);return a=a.replace(/\{block\}/,styleBlock[b])}function HtmlFormat(a){a=a.replace(/  /g," \x26nbsp;");return a=a.replace(/\n/g,"\x3cbr/\x3e")}
function DetectBlocks(a,b){b.oldStart=[];b.oldToNew=[];b.oldLength=[];b.oldWords=[];b.newStart=[];b.newLength=[];b.newWords=[];b.newNumber=[];b.newBlock=[];b.newLeft=[];b.newRight=[];b.newLeftIndex=[];b.newRightIndex=[];var c=0,d=0,e=0;if(showBlockMoves){i=j=0;do{(a.oldToNew[j]!=i||0==c)&&(null!=a.oldToNew[j]||j>=a.oldWords.length)&&(null!=a.newToOld[i]||i>=a.newWords.length)&&(0<c&&(b.oldLength[c-1]=d,b.oldWords[c-1]=e,e=d=0),j>=a.oldWords.length?j++:(i=a.oldToNew[j],b.oldStart[c]=j,b.oldToNew[c]=
a.oldToNew[j],c++));for(;i<a.newWords.length&&j<a.oldWords.length&&null!=a.newToOld[i]&&null!=a.oldToNew[j]&&a.oldToNew[j]==i;)i++,j++,d++,/\w/.test(a.newWords[i])&&e++;for(;null==a.oldToNew[j]&&j<a.oldWords.length;)j++;for(;null==a.newToOld[i]&&i<a.newWords.length;)i++}while(j<=a.oldWords.length);var h;a=null;for(i=0;i<c;i++){currMin=null;for(j=0;j<c;j++)if(curr=b.oldToNew[j],curr>a||null==a)if(curr<currMin||null==currMin)currMin=curr,h=j;b.newStart[i]=b.oldToNew[h];b.newLength[i]=b.oldLength[h];
b.newWords[i]=b.oldWords[h];b.newNumber[i]=h;a=currMin}for(i=0;i<c;i++)null==b.newBlock[i]&&b.newNumber[i]==i&&(b.newBlock[i]=0);for(i=0;i<c-1;i++)null==b.newBlock[i]&&null==b.newBlock[i+1]&&1==b.newNumber[i]-b.newNumber[i+1]&&(1!=b.newNumber[i+1]-b.newNumber[i+2]||i+2>=c)&&(b.newLength[i]<b.newLength[i+1]?(b.newBlock[i]=1,b.newBlock[i+1]=0):(b.newBlock[i]=0,b.newBlock[i+1]=1));j=1;for(i=0;i<c;i++)if(null==b.newBlock[i]||1==b.newBlock[i])b.newBlock[i]=j++;for(i=0;i<c;i++)for(j=0;j<c;j++)b.newNumber[j]==
i&&0<b.newBlock[j]&&(b.newNumber[j]<j?(b.newRight[i]=b.newBlock[j],b.newRightIndex[i]=j):(b.newLeft[i+1]=b.newBlock[j],b.newLeftIndex[i+1]=j))}}function comparerAction(a){var b="",c=a.children(".content").first().text(),d=a.children(".content").last().text(),b=b+StringDiff2(c,d);a.children(".content").first().html("\x3cspan\x3e"+b+"\x3c/span\x3e");b=""+StringDiff1(c,d);a.children(".content").last().html("\x3cspan\x3e"+b+"\x3c/span\x3e");return a};