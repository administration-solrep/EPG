<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org">
    <body>
        <div th:fragment="blocDetail(nom, titre, elements)" class="m-t-4 accordion">
            <button
                class="accordion__header js-toggle accordion__header--default"
                th:id="|accordion__header__${nom}|"
                aria-expanded="true"
                th:aria-controls="|accordion__content__${nom}|"
                type="button"
                data-toggle="accordion__content"
                data-icon-opened="substract"
                data-icon-closed="add"
            >
                [[#{${titre}}]] : [[${id}]] ([[${curVersion}]])
                <span class="icon accordion__icon accordion__icon--default icon--substract" aria-hidden="true"></span>
            </button>

            <div
                class="accordion__content accordion__content--accordion--default accordion__content--is-opened"
                th:id="|accordion__content__${nom}|"
                aria-hidden="false"
            >
                <div class="flex items-center">
                    <div class="form-select form-select--simple form-select--inline">
                        <div class="form-input form-input--inline">
                            <div class="form-input__header">
                                <div class="form-input__header-top">
                                    <label for="form-select-default" id="form-select-default_label" class="form-label"
                                        >[[#{label.mgpp.dossier.onglets.fiche.version}]]</label
                                    >
                                </div>
                            </div>
                            <div class="form-input__container">
                                <div class="form-select__field-wrapper">
                                    <div class="form-select-input">
                                        <select
                                            name="form-select-default"
                                            id="version-selector"
                                            class="form-select-input__field form-select-input__field--simple"
                                        >
                                            <th:block th:each="version:${lstVersions}">
                                                <option
                                                    th:value="${version.value}"
                                                    th:data-description="${version.getDescription()}"
                                                    th:classappend="${version.rejete}?'cell-crossed'"
                                                    th:selected="${curVersion.equals(version.text)}"
                                                    >[[${version.text}]]</option
                                                >
                                            </th:block>
                                        </select>
                                        <span aria-hidden="true" tabindex="-1"
                                            ><span
                                                aria-hidden="true"
                                                class="icon icon--arrow-bottom form-select-input__arrow"
                                            ></span
                                        ></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button
                        type="button"
                        onclick="changeVersion()"
                        id="change-version"
                        class="m-l-4 base-btn base-btn--button base-btn--default base-btn--icon-action-blue base-btn--center base-btn--transparent"
                    >
                        <span aria-hidden="true" class="icon icon--refresh"></span
                        ><span class="sr-only" th:text="#{admin.acces.format.actualiser}"></span>
                    </button>
                    <p class="m-b-0 m-l-4" id="version-message">[[${curDescription}]]</p>
                </div>

                <div th:if="${!#strings.isEmpty(natureVersion)}" class="alert__light m-y-5 alert alert--warning">
                    <input type="hidden" name="targetId" th:value="d_communication_content" />
                    <div class="alerts--flex">
                        <span
                            aria-hidden="true"
                            class="icon icon--information bubble-icon alert__icon alert__icon--warning"
                        ></span>
                        <span class="sr-only" th:text="#{login.alerte}"></span>
                        <p class="alert__content">[[${natureVersion}]]</p>
                    </div>
                </div>

                <ul class="labellised-list">
                    <th:block th:each="widget : ${elements}">
                        <li class="labellised-list__item">
                            <th:block th:if="${widget.typeChamp} == 'text'">
                                <th:block th:replace="fragments/mgpp/widgets/text :: text(${widget})"></th:block>
                            </th:block>
                            <th:block th:if="${widget.typeChamp} == 'url'">
                                <th:block th:replace="fragments/mgpp/widgets/text-url :: textUrl(${widget})"></th:block>
                            </th:block>
                            <th:block th:if="${widget.typeChamp}== 'input-text'">
                                <th:block
                                    th:replace="fragments/mgpp/widgets/input-text :: inputText(${widget})"
                                ></th:block>
                            </th:block>
                            <th:block th:if="${widget.typeChamp} == 'textarea'">
                                <th:block
                                    th:replace="fragments/mgpp/widgets/textarea :: textarea(${widget})"
                                ></th:block>
                            </th:block>
                            <th:block th:if="${widget.typeChamp} == 'date'">
                                <th:block th:replace="fragments/mgpp/widgets/date :: date(${widget})"></th:block>
                            </th:block>
                            <th:block th:if="${widget.typeChamp} == 'radio'">
                                <th:block
                                    th:replace="fragments/mgpp/widgets/optin-radio :: optinRadio(${widget})"
                                ></th:block>
                            </th:block>
                            <th:block th:if="${widget.typeChamp} == 'niveau-lecture'">
                                <th:block
                                    th:replace="fragments/mgpp/widgets/niveau-lecture :: niveauLecture(${widget})"
                                ></th:block>
                            </th:block>
                            <th:block th:if="${widget.typeChamp} == 'select'">
                                <th:block th:replace="fragments/mgpp/widgets/select :: select(${widget})"></th:block>
                            </th:block>
                            <th:block th:if="${widget.typeChamp} == 'piece-jointe'">
                                <th:block
                                    th:replace="fragments/mgpp/widgets/piece-jointe :: pieceJointe(${widget})"
                                ></th:block>
                            </th:block>
                            <th:block th:if="${widget.typeChamp} == 'file-multi'">
                                <th:block
                                    th:replace="fragments/mgpp/widgets/file-multi :: fileMulti(${widget})"
                                ></th:block>
                            </th:block>
                            <th:block th:if="${widget.typeChamp} == 'multiple-input-text'">
                                <th:block
                                    th:replace="fragments/mgpp/widgets/multiple-input-text :: multipleInputText(${widget})"
                                ></th:block> </th:block
                            ><th:block th:if="${widget.typeChamp} == 'multiple_date'">
                                <th:block
                                    th:replace="fragments/mgpp/widgets/multiple-date :: multipleDate(${widget})"
                                ></th:block>
                            </th:block>
                        </li>
                    </th:block>
                </ul>

                <th:block th:if="${displayComSuccessive == true}">
                    <th:block
                        th:replace="fragments/components/bloc-communication-successive :: bloc-communication-successive(${comSuccessiveSelect})"
                    ></th:block>
                </th:block>

                <div class="row-actions">
                    <div class="row-actions__left" th:if="${baseActions !=null && not #lists.isEmpty(baseActions)}">
                        <th:block th:each="action : ${baseActions}">
                            <button
                                th:replace="fragments/components/label-action-button :: label-action-button(${action}, false, ${action.type == 'secondary' ? 'base-btn--secondary' : action.type == 'tertiary' ? 'base-btn--light base-btn--transparent base-btn--bordered' : ''})"
                            ></button>
                        </th:block>
                    </div>
                    <div class="row-actions__right" th:if="${mainActions !=null && not #lists.isEmpty(mainActions)}">
                        <th:block th:each="action : ${mainActions}">
                            <button
                                th:replace="fragments/components/label-action-button :: label-action-button(${action}, false, ${action.type == 'secondary' ? 'base-btn--secondary' : action.type == 'tertiary' ? 'base-btn--light base-btn--transparent base-btn--bordered' : ''})"
                            ></button>
                        </th:block>
                    </div>
                </div>
            </div>

            <!-- Modal de de liaison à un organisme extra-parlementaire -->
            <div th:replace="fragments/mgpp/components/mgpp-modal-lier-oep :: mgpp-modal-lier-oep"></div>
        </div>
    </body>
</html>
