<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org">
    <body>
        <div
            th:fragment="searchResults(corbeille)"
            class="tableForm"
            th:data-url="@{${dataUrl}}"
            th:data-ajaxurl="@{${dataAjaxUrl}}"
            id="listeCommunications"
        >
            <div class="overlay" th:id="result_overlay" aria-live="polite">
                <img width="29" height="29" th:src="@{/img/loader.svg}" alt="" />
            </div>

            <th:block th:if="${#lists.isEmpty(resultList.liste)}">
                <h2
                    class="search-result-form__title base-title base-title--lvl-3"
                    th:text="#{recherche.result.title}"
                ></h2>
                <h3
                    class="search-result-form__subtitle base-title base-title--lvl-4"
                    th:text="#{recherche.result.aucun}"
                ></h3>
            </th:block>

            <th:block th:unless="${#lists.isEmpty(resultList.liste)}">
                <th:block th:if="${resultVisible}">
                    <h2 class="m-t-8 m-b-6 base-title base-title--lvl-3" th:text="#{recherche.result.title}"></h2>
                    <h3
                        class="m-y-6 p-b-2 base-title base-title--lvl-4 base-title--is-underlined"
                        th:text="#{rechercher.dossiers.nbResults(${resultList.nbTotal})}"
                    ></h3>
                    <div id="focusResultat" tabindex="-1"></div>
                </th:block>
                <input
                    id="idCorbeille"
                    name="idCorbeille"
                    th:value="${corbeille}"
                    type="hidden"
                    aria-hidden="true"
                    data-isForm="true"
                />

                <div class="table-action">
                    <div class="table-action__action-container table-action__action-container--left">
                        <div class="table-action__group">
                            <div th:replace="fragments/table/toolbarMgpp :: toolbar('action_export', false)"></div>
                        </div>
                    </div>
                    <div class="table-action__action-container table-action__action-container--right">
                        <th:block th:unless="${resultList.liste.size == resultList.nbTotal}">
                            <nav
                                th:replace="fragments/table/pagination :: pagination (${resultForm},${resultForm.page}, 'com_haut', ${resultList.nbTotal})"
                            ></nav>
                        </th:block>
                    </div>
                </div>

                <table class="custom-table">
                    <thead class="table-header custom-table__header">
                        <tr class="table-header__line">
                            <th:block th:each="colonne : ${lstColonnes}">
                                <th:block th:if="${colonne.visible && colonne.sortable}">
                                    <th scope="col" class="table-header__cell table-header__cell--with-filter-action">
                                        <button
                                            th:replace="fragments/table/sortableHeader :: sortableHeader (#{__${colonne.label}__},${colonne.sortValue},${colonne.sortName},${colonne.sortId}, false)"
                                        ></button>
                                    </th>
                                </th:block>

                                <th:block th:if="${colonne.visible && !colonne.sortable}">
                                    <th scope="col" class="table-header__cell">
                                        <span
                                            class="tabla-header__cell-inner"
                                            th:text="${colonne.label !=null? #messages.msg(colonne.label) : ''}"
                                        >
                                            &nbsp;
                                        </span>
                                    </th>
                                </th:block>
                            </th:block>
                        </tr>
                    </thead>
                    <tbody class="custom-table__body">
                        <th:block th:unless="${#lists.isEmpty(resultList.liste)}">
                            <tr
                                class="custom-table__table-line table-line table-line--with-action-column table-line--complex-line"
                                th:each="item, nb : ${resultList.liste}"
                            >
                                <th:block th:each="line, ln :${item}">
                                    <th:block th:if="${ln.index == 1}">
                                        <td class="table-line__cell">
                                            <th:block th:if="${#strings.isEmpty(line.value)}">
                                                <a
                                                    th:href="@{|/mgpp/dossierSimple/${item.ficheId}/fiche|}"
                                                    class="link"
                                                >
                                                    <span class="sr-only" th:text="#{lien.consulter.fiche}"></span>
                                                    <span
                                                        aria-hidden="true"
                                                        class="icon icon--link link__icon link__icon--append link__icon--large base-btn--icon-action-blue"
                                                    ></span>
                                                </a>
                                            </th:block>
                                            <th:block th:unless="${#strings.isEmpty(line.value)}">
                                                <a
                                                    th:href="@{|/mgpp/dossierSimple/${item.ficheId}/fiche|}"
                                                    th:utext="${line.value}"
                                                    class="link"
                                                ></a>
                                            </th:block>
                                        </td>
                                    </th:block>
                                    <th:block th:if="${ln.index > 1}">
                                        <td class="table-line__cell" th:utext="${line.value}"></td>
                                    </th:block>
                                </th:block>
                            </tr>
                        </th:block>
                    </tbody>
                </table>

                <div class="table-action">
                    <div class="table-action__action-container table-action__action-container--disabled"></div>
                    <div class="table-action__action-container table-action__action-container--right">
                        <th:block th:unless="${resultList.liste.size == resultList.nbTotal}">
                            <nav
                                th:replace="fragments/table/pagination :: pagination (${resultForm},${resultForm.page}, 'com_haut', ${resultList.nbTotal})"
                            ></nav>
                        </th:block>
                    </div>
                </div>
            </th:block>
        </div>
    </body>
</html>
